<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco Adaptive Security Appliance Software and Cisco Firepower Threat Defense Software Denial of Service Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20181031-asaftd-sip-dos</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.5</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2018-10-31T19:35:10</cvrf:Date>
        <cvrf:Description>Initial public release.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.1</cvrf:Number>
        <cvrf:Date>2018-11-01T16:17:33</cvrf:Date>
        <cvrf:Description>Added Rate Limiting mitigation.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.2</cvrf:Number>
        <cvrf:Date>2018-11-02T16:02:57</cvrf:Date>
        <cvrf:Description>Clarified that both physical and virtual appliances are affected and that disabling SIP on FTD needs to be done via CLI.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.3</cvrf:Number>
        <cvrf:Date>2018-11-06T21:02:42</cvrf:Date>
        <cvrf:Description>Updated the Fixed Software section.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.4</cvrf:Number>
        <cvrf:Date>2018-11-14T19:54:13</cvrf:Date>
        <cvrf:Description>Updated the Fixed Software section.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.5</cvrf:Number>
        <cvrf:Date>2018-11-16T21:19:02</cvrf:Date>
        <cvrf:Description>Finalized the Fixed Software section.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2018-10-31T19:30:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2018-11-16T21:19:02</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the Session Initiation Protocol (SIP) inspection  engine of Cisco Adaptive Security Appliance (ASA) Software and Cisco  Firepower Threat Defense (FTD) Software could allow an unauthenticated,  remote attacker to cause an affected device to reload or trigger high CPU, resulting in a  denial of service (DoS) condition.

The vulnerability is due to  improper handling of SIP traffic. An attacker could exploit  this vulnerability by sending SIP requests designed to specifically trigger this issue at a high rate across an affected  device.
Cisco has released software updates that address this vulnerability. There are no workarounds that address this vulnerability. Mitigation options that address this vulnerability are available.

This advisory is available at the following link:
https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181031-asaftd-sip-dos ["https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181031-asaftd-sip-dos"]</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="2">This vulnerability affects Cisco ASA Software Release 9.4 and later and Cisco FTD Software Release 6.0 and later on both physical and virtual appliances if SIP inspection is enabled and the software is running on any of the following Cisco products:

3000 Series Industrial Security Appliance (ISA)
ASA 5500-X Series Next-Generation Firewalls
ASA Services Module for Cisco Catalyst 6500 Series Switches and Cisco 7600 Series Routers
Adaptive Security Virtual Appliance (ASAv)
Firepower 2100 Series Security Appliance
Firepower 4100 Series Security Appliance
Firepower 9300 ASA Security Module
FTD Virtual (FTDv)

SIP inspection is enabled by default in both Cisco ASA Software and Cisco FTD Software. For detailed information about the default settings for application inspection policies, refer to the Cisco ASA Series Firewall CLI Configuration Guide ["https://www.cisco.com/c/en/us/td/docs/security/asa/asa99/configuration/firewall/asa-99-firewall-config/inspect-service-policy.html#ID-2094-0000026e"].

Determine the Cisco ASA Software Release
To determine which Cisco ASA Software release is running on a device, administrators can log in to the device, use the show version command in the CLI, and refer to the output of the command. The following example shows the output of the command for a device that is running Cisco ASA Software Release 9.4(4):


ciscoasa# show version | include Version
  Cisco Adaptive Security Appliance Software Version 9.4(4)  Device Manager Version 7.4(1)  .  .  .

If a device is managed by using Cisco Adaptive Security Device Manager (ASDM), administrators can also determine which release is running on a device by referring to the release information in the table that appears in the Cisco ASDM log in window or the Device Dashboard tab of the Cisco ASDM Home pane.


Determine the Cisco FTD Software Release
To determine which Cisco FTD Software release is running on a device, administrators can log in to the device, use the show version command in the CLI, and refer to the output of the command. The following example shows the output of the command for a device that is running Cisco FTD Software Release 6.2.0:


&gt; show version
  ---------------------[ ftd ]---------------------  Model : Cisco ASA5525-X Threat Defense (75) Version 6.2.0 (Build 362)  UUID : 2849ba3c-ecb8-11e6-98ca-b9fc2975893c  Rules update version : 2017-03-15-001-vrt  VDB version : 279  ----------------------------------------------------</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="3">Only products listed in the Vulnerable Products ["#vp"] section of this advisory are known to be affected by this vulnerability.

Cisco has confirmed that this vulnerability does not affect the following Cisco products:

ASA 1000V Cloud Firewall
ASA 5500 Series Adaptive Security Appliances</cvrf:Note>
    <cvrf:Note Title="Indicators of Compromise" Type="General" Ordinal="4">While the vulnerability described in this advisory is being actively exploited, the output of show conn port 5060 will show a large number of incomplete SIP connections and the output of show processes cpu-usage non-zero sorted will show a high CPU utilization.

Successful exploitation of this vulnerability can also result in the affected device crashing and reloading. After the device boots up again, the output of show crashinfo will show an unknown abort of the DATAPATH thread. Customer should reach out to Cisco TAC with this information to determine whether the particular crash was related to exploitation of this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="5">There are no workarounds that address this vulnerability; however, there are several mitigation options. These mitigation options apply to both physical and virtual appliances.
  Option 1: Disable SIP Inspection
Disabling SIP inspection will completely close the attack vector for this vulnerability. However, it may not be suitable for all customers. In particular, disabling SIP inspection would break SIP connections if either NAT is applied to SIP traffic or if not all ports required for SIP communication are opened via ACL.

To disable SIP inspection, configure the following:

Cisco ASA Software
policy-map global_policy
 class inspection_default
  no inspect sip

Cisco FTD Software Releases
configure inspection sip disable


Note: This command is issued from the FTD CLI.

  Option 2: Block the Offending Host(s)
Customers can block traffic from the specific source IP address seen in the connection table using an access control list (ACL). After applying the ACL, make sure to clear existing connections for that source using the clear conn address &lt;ip_address&gt; command in EXEC mode.

Alternatively, the offending host can be shunned using the shun &lt;ip_address&gt; command in EXEC mode. This will block all packets from that source IP without the need for a configuration change. However, please be aware that shunning does not persist across reboot.
  Option 3: Filter on Sent-by Address of 0.0.0.0
In observed cases, the offending traffic has been found to have the Sent-by Address set to the invalid value of 0.0.0.0. If an administrator confirms that the offending traffic shows the same pattern in their environment (e.g. confirmed via packet capture), the following configuration can be applied to prevent the crash:


regex VIAHEADER "0.0.0.0"

policy-map type inspect sip P1
parameters
match message-path regex VIAHEADER
drop

policy-map global_policy
class inspection_default
no inspect sip
inspect sip P1

In FTD 6.2 and later, use Cisco Firepower Management Center (FMC) to add this configuration via FlexConfig policy.
  Option 4: Rate Limit SIP Traffic
  This vulnerability can also be mitigated by implementing a rate limit on SIP traffic using the Modular Policy Framework (MPF). The implementation of these policies will differ depending on the deployment specifics and implementation choices made in each environment. Customers who need assistance implementing an MPF policy should contact the Cisco TAC or their Advanced Services (AS) representative for assistance.

Note: An attacker could exploit this vulnerability using spoofed IP packets.</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="6">Cisco is in the process of releasing free software updates that address the vulnerability described in this advisory. Customers may only install and expect support for software versions and feature sets for which they have purchased a license. By installing, downloading, accessing, or otherwise using such software upgrades, customers agree to follow the terms of the Cisco software license:
https://www.cisco.com/c/en/us/products/end-user-license-agreement.html ["https://www.cisco.com/c/en/us/products/end-user-license-agreement.html"]

Additionally, customers may only download software for which they have a valid license, procured from Cisco directly, or through a Cisco authorized reseller or partner. In most cases this will be a maintenance upgrade to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

When considering software upgrades, customers are advised to regularly consult the advisories for Cisco products, which are available from the Cisco Security Advisories and Alerts page ["https://www.cisco.com/go/psirt"], to determine exposure and a complete upgrade solution.

In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.
  Customers Without Service Contracts
Customers who purchase directly from Cisco but do not hold a Cisco service contract and customers who make purchases through third-party vendors but are unsuccessful in obtaining fixed software through their point of sale should obtain upgrades by contacting the Cisco TAC:
https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html ["https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html"]

Customers should have the product serial number available and be prepared to provide the URL of this advisory as evidence of entitlement to a free upgrade.

Cisco ASA Software
                                Cisco ASA Software Release              First Fixed Release                                              9.3 and Prior1                            Not vulnerable                                              9.4              9.4.4.27                                  9.51                          Migrate to first fixed 9.6 or later version                                  9.6               9.6.4.18                                  9.71              Migrate to first fixed 9.8 or later version                                  9.8              9.8.3.16                                  9.9               9.9.2.32                                  9.10              9.10.1.2
1 Cisco ASA Software releases prior to Release 9.1 and Cisco ASA Software Releases 9.2, 9.3, 9.5, and 9.7 have reached the end-of-software-maintenance milestone. Customers are advised to migrate to a supported release that includes the fix for this vulnerability.

Cisco FTD Software
                                Cisco FTD Software Release              First Fixed Release for This Vulnerability                                              6.0              Migrate to a fixed release in 6.1.0 or later                                  6.0.1              Migrate to a fixed release in 6.1.0 or later                                  6.1.0                          6.1.0.7 Hotfix ER                                  6.2.0                          6.2.0.6 Hotfix CE                                  6.2.1                          Migrate to a fixed release in 6.2.2 or later                                  6.2.2                          6.2.2.4 Hotfix BZ                                  6.2.3               6.2.3.7

To upgrade to a fixed release of Cisco Firepower System Software, customers can do one of the following:

For devices that are managed by using Cisco Firepower Management Center (FMC), use the FMC interface to install the upgrade and, after installation is complete, reapply the access control policy. The Snort version that is installed depends on the FMC release.
For devices that are managed by using Cisco Adaptive Security Device Manager (ASDM) or Cisco Firepower Device Manager (FDM), use the ASDM or FDM interface to install the upgrade and, after installation is complete, reapply the access control policy.</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="7">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy ["http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="8">The Cisco Product Security Incident Response Team (PSIRT) has become aware of active exploitation of the vulnerability that is described in this advisory.</cvrf:Note>
    <cvrf:Note Title="Source" Type="General" Ordinal="9">This vulnerability was found during the resolution of a Cisco TAC support case.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181031-asaftd-sip-dos</cvrf:URL>
      <cvrf:Description>Cisco Adaptive Security Appliance Software and Cisco Firepower Threat Defense Software Denial of Service Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Adaptive Security Appliance (ASA) Software" Type="Product Name">
        <FullProductName ProductID="CVRFPID-6588">Cisco Adaptive Security Appliance (ASA) Software </FullProductName>
      </Branch>
      <Branch Name="Cisco Firepower Threat Defense Software" Type="Product Name">
        <FullProductName ProductID="CVRFPID-220203">Cisco Firepower Threat Defense Software </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>vuln_cisco-sa-20181031-asaftd-sip-dos</Title>
    <ID SystemName="Cisco Bug ID">CSCvm43975</ID>
    <Notes>
      <Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the Session Initiation Protocol (SIP) inspection
engine of Cisco Adaptive Security Appliance (ASA) Software and Cisco
Firepower Threat Defense (FTD) Software could allow an unauthenticated,
remote attacker to cause an affected device to reload or trigger high CPU, resulting in a
denial of service (DoS) condition.



The vulnerability is due to
improper handling of SIP traffic. An attacker could exploit
this vulnerability by sending SIP requests designed to specifically trigger this issue at a high rate across an affected
device.</Note>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="2">CSCvm43975</Note>
    </Notes>
    <CVE>CVE-2018-15454</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-6588</ProductID>
        <ProductID>CVRFPID-220203</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV3>
        <BaseScoreV3>8.6</BaseScoreV3>
        <VectorV3>CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H</VectorV3>
      </ScoreSetV3>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>There are no workarounds that address this vulnerability; however, there are several mitigation options. These mitigation options apply to both physical and virtual appliances.
  Option 1: Disable SIP Inspection
Disabling SIP inspection will completely close the attack vector for this vulnerability. However, it may not be suitable for all customers. In particular, disabling SIP inspection would break SIP connections if either NAT is applied to SIP traffic or if not all ports required for SIP communication are opened via ACL.

To disable SIP inspection, configure the following:

Cisco ASA Software
policy-map global_policy
 class inspection_default
  no inspect sip

Cisco FTD Software Releases
configure inspection sip disable


Note: This command is issued from the FTD CLI.

  Option 2: Block the Offending Host(s)
Customers can block traffic from the specific source IP address seen in the connection table using an access control list (ACL). After applying the ACL, make sure to clear existing connections for that source using the clear conn address &lt;ip_address&gt; command in EXEC mode.

Alternatively, the offending host can be shunned using the shun &lt;ip_address&gt; command in EXEC mode. This will block all packets from that source IP without the need for a configuration change. However, please be aware that shunning does not persist across reboot.
  Option 3: Filter on Sent-by Address of 0.0.0.0
In observed cases, the offending traffic has been found to have the Sent-by Address set to the invalid value of 0.0.0.0. If an administrator confirms that the offending traffic shows the same pattern in their environment (e.g. confirmed via packet capture), the following configuration can be applied to prevent the crash:


regex VIAHEADER "0.0.0.0"

policy-map type inspect sip P1
parameters
match message-path regex VIAHEADER
drop

policy-map global_policy
class inspection_default
no inspect sip
inspect sip P1

In FTD 6.2 and later, use Cisco Firepower Management Center (FMC) to add this configuration via FlexConfig policy.
  Option 4: Rate Limit SIP Traffic
  This vulnerability can also be mitigated by implementing a rate limit on SIP traffic using the Modular Policy Framework (MPF). The implementation of these policies will differ depending on the deployment specifics and implementation choices made in each environment. Customers who need assistance implementing an MPF policy should contact the Cisco TAC or their Advanced Services (AS) representative for assistance.

Note: An attacker could exploit this vulnerability using spoofed IP packets.</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181031-asaftd-sip-dos</URL>
        <Description>Cisco Adaptive Security Appliance Software and Cisco Firepower Threat Defense Software Denial of Service Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>