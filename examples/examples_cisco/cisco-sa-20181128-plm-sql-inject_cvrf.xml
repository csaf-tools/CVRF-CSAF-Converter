<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco Prime License Manager SQL Injection Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20181128-plm-sql-inject</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.3</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2018-11-28T15:42:11</cvrf:Date>
        <cvrf:Description>Initial public release.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.1</cvrf:Number>
        <cvrf:Date>2018-12-04T16:34:44</cvrf:Date>
        <cvrf:Description>Added details on how to disable a coresident installation of PLM.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.2</cvrf:Number>
        <cvrf:Date>2018-12-10T18:27:03</cvrf:Date>
        <cvrf:Description>Added information about functional issues that were discovered with the initial COP file.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.3</cvrf:Number>
        <cvrf:Date>2018-12-20T15:33:50</cvrf:Date>
        <cvrf:Description>Added information about updated COP file.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2018-11-28T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2018-12-20T15:33:50</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">Update (2018-December-20): The updated patch ciscocm.CSCvk30822_v2.0.k3.cop.sgn  that avoids the functional issues identified with the v1.0 patch has been posted to Cisco.com. See the Fixed Releases ["#fr"]  section for details.

Update (2018-December-10): Installing the ciscocm.CSCvk30822_v1.0.k3.cop.sgn  patch may cause functional issues. Workarounds are available for some of these issues. Rolling back this patch as described in the Fixed Releases ["#fr"] section will correct these functional issues, but  the device will be affected by this vulnerability again when the patch is not in place. See the Fixed Releases ["#fr"] section for details.


A vulnerability in the web framework code of Cisco Prime License Manager  (PLM) could allow an unauthenticated, remote attacker to execute arbitrary SQL queries.
  The vulnerability is due to a lack of proper validation of user-supplied input in SQL queries. An attacker could exploit this vulnerability by sending crafted HTTP POST requests that contain malicious SQL statements to an affected application. A successful exploit could allow the attacker to modify and delete arbitrary data in the PLM database or gain shell access with the privileges of the postgres user.

Cisco has released software updates that address this vulnerability. There are no workarounds that address this vulnerability.

This advisory is available at the following link:
https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181128-plm-sql-inject ["https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181128-plm-sql-inject"]</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="2">This vulnerability affects Cisco Prime License Manager Releases 11.0.1 and later. Both standalone deployments of Cisco Prime License Manager and coresident deployments, where Cisco Prime License Manager is installed automatically as part of the installation of Cisco Unified Communications Manager and Cisco Unity Connection, are affected.

To identify which release of Cisco Prime License Manager is running, administrators can log in to the Cisco Prime License Manager GUI and click About in the top-right corner of the screen. The following example shows the Version string that is reported by a Cisco Prime License Manager instance that is running the 11.5.1 release:


Version: 11.5.1.10000-5</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="3">Only products listed in the Vulnerable Products ["#vp"] section of this advisory are known to be affected by this vulnerability.

Cisco Unified Communications Manager and Cisco Unity Connection Releases 12.0 and later have been confirmed to be not affected by this vulnerability as Cisco Prime License Manager is no longer included in these releases.</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="4">There are no workarounds that address this vulnerability.

Customers with coresident deployments of Cisco Prime License Manager as part of Cisco Unified Communications Manager or Cisco Unity Connection who do not use PLM can disable the feature to close the attack vector as follows:

Log in to the Cisco Unified Communications Manager or Cisco Unity Connection CLI as admin user.
Run the command license management system remove.
Confirm with y.
Wait for the operation to complete; afterwards, the system will reboot automatically.

Note: This procedure needs to be executed on all nodes in a cluster. It will persist across upgrades.</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="5">Cisco has released free software updates that address the vulnerability described in this advisory. Customers may only install and expect support for software versions and feature sets for which they have purchased a license. By installing, downloading, accessing, or otherwise using such software upgrades, customers agree to follow the terms of the Cisco software license:
https://www.cisco.com/c/en/us/products/end-user-license-agreement.html ["https://www.cisco.com/c/en/us/products/end-user-license-agreement.html"]

Additionally, customers may only download software for which they have a valid license, procured from Cisco directly, or through a Cisco authorized reseller or partner. In most cases this will be a maintenance upgrade to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

When considering software upgrades, customers are advised to regularly consult the advisories for Cisco products, which are available from the Cisco Security Advisories and Alerts page ["https://www.cisco.com/go/psirt"], to determine exposure and a complete upgrade solution.

In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.
  Customers Without Service Contracts
Customers who purchase directly from Cisco but do not hold a Cisco service contract and customers who make purchases through third-party vendors but are unsuccessful in obtaining fixed software through their point of sale should obtain upgrades by contacting the Cisco TAC:
https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html ["https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html"]

Customers should have the product serial number available and be prepared to provide the URL of this advisory as evidence of entitlement to a free upgrade.
    Fixed Releases
This vulnerability is fixed in Cisco Prime License Manager patch ciscocm.CSCvk30822_v2.0.k3.cop.sgn (the v1.0 release of this patch should no longer be used due to functional issues caused by that version of the patch). The same COP file can be used with standalone deployments of Cisco Prime License Manager as well as with coresident deployments as part of Cisco Unified Communications Manager and Cisco Unity Connection and with all affected versions. Installation instructions are available in a corresponding Readme document.

Note: This patch can be installed on Cisco Prime License Manager, Cisco Unified Communications Manager, and Cisco Unity Connection 11.5(1) only. Customers running an earlier release will need to upgrade to 11.5(1) prior to installing this patch.

Functional Issues Identified in the v1.0 Patch File

Installing the ciscocm.CSCvk30822_v1.0.k3.cop.sgn patch on standalone or coresident PLM will resolve the vulnerability described in this advisory, but this action will disable the following features:

Install/upgrade functionality in the PLM GUI
Backup and Restore functionality in the PLM GUI

Workarounds for the Functional Issues
  Standalone PLM
Install/upgrade can be accomplished by using the CLI.
There is no workaround for the Backup and Restore functionality.
  Coresident PLM
Install/upgrade can be accomplished by using the CUCM/CUC GUI.
Backup and Restore functionality continues to be available in the CUCM/CUC GUI.

Upgrading from the v1.0 Patch to the v2.0 Patch


Customers who have previously installed the ciscocm.CSCvk30822_v1.0.k3.cop.sgn patch should upgrade to the ciscocm.CSCvk30822_v2.0.k3.cop.sgn patch to remediate the functional issues. Installing the v2.0 patch will first rollback the v1.0 patch and then install the v2.0 patch:

 Download the ciscocm.CSCvk30822_v2.0.k3.cop.sgn file from the locations indicated in the Patch and Patch Rollback File Download ["#dl"] section of this advisory.
Install that downloaded file by using the CLI (for a standalone PLM) or by using the CUCM/CUC GUI (for a coresident PLM).

Patch and Patch Rollback File Download

The patch files and patch rollback files, including a Readme document, are available for download from the Software Center ["https://software.cisco.com/download/navigator.html"] on Cisco.com by navigating to the following locations:

Cisco Prime License Manager
Browse all &gt; Cloud and Systems Management &gt; Collaboration and Unified  Communications Management &gt; Prime License Manager &gt; Prime License  Manager 11.5 &gt; Prime License Manager Software Patches &gt; UTILS

Cisco Unified Communications Manager
Browse all &gt; Unified Communications &gt; Call Control &gt; Unified Communications Manager (CallManager) &gt; Unified Communications Manager Version 11.5 &gt; Unified Communications Manager / CallManager / Cisco Unity Connection Utilities &gt; COP-Files

Cisco Unity Connection
Browse all &gt; Unified Communications &gt; Unified Communications Applications &gt; Messaging &gt; Unity Connection &gt; Unity Connection Version 11.x &gt; Unified Communications Manager / CallManager / Cisco Unity Connection Utilities &gt; COP-Files</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="6">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy ["http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="7">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory.</cvrf:Note>
    <cvrf:Note Title="Source" Type="General" Ordinal="8">Cisco would like to thank security researcher Suhail Alaskar of Saudi Information Technology Company for reporting this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="9">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181128-plm-sql-inject</cvrf:URL>
      <cvrf:Description>Cisco Prime License Manager SQL Injection Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Prime License Manager" Type="Product Name">
        <FullProductName ProductID="CVRFPID-203607">Cisco Prime License Manager </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco Prime License Manager SQL Injection Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCvk30822</ID>
    <Notes>
      <Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the web framework code of Cisco Prime License Manager
(PLM) could allow an unauthenticated, remote attacker to execute arbitrary SQL queries.


The vulnerability is due to a lack of proper validation of user-supplied input in SQL queries. An attacker could exploit this vulnerability by sending crafted HTTP POST requests that contain malicious SQL statements to an affected application. A successful exploit could allow the attacker to modify and delete arbitrary data in the PLM database or gain shell access with the privileges of the postgres user.</Note>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="2">CSCvk30822</Note>
    </Notes>
    <CVE>CVE-2018-15441</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-203607</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV3>
        <BaseScoreV3>9.4</BaseScoreV3>
        <VectorV3>CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:H</VectorV3>
      </ScoreSetV3>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>There are no workarounds that address this vulnerability.

Customers with coresident deployments of Cisco Prime License Manager as part of Cisco Unified Communications Manager or Cisco Unity Connection who do not use PLM can disable the feature to close the attack vector as follows:

Log in to the Cisco Unified Communications Manager or Cisco Unity Connection CLI as admin user.
Run the command license management system remove.
Confirm with y.
Wait for the operation to complete; afterwards, the system will reboot automatically.

Note: This procedure needs to be executed on all nodes in a cluster. It will persist across upgrades.</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181128-plm-sql-inject</URL>
        <Description>Cisco Prime License Manager SQL Injection Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>