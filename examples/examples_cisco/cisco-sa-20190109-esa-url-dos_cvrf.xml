<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco Email Security Appliance URL Filtering Denial of Service Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20190109-esa-url-dos</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.1</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2019-01-09T15:58:24</cvrf:Date>
        <cvrf:Description>Initial public release.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.1</cvrf:Number>
        <cvrf:Date>2019-03-13T14:25:33</cvrf:Date>
        <cvrf:Description>Added details regarding the URL filtering-related workaround.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2019-01-09T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2019-03-13T14:25:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the email message filtering feature of Cisco AsyncOS Software for Cisco Email Security Appliances (ESA) could allow an unauthenticated, remote attacker to cause the CPU utilization to increase to 100 percent, causing a denial of service (DoS) condition on an affected device.

The vulnerability is due to improper filtering of email messages that contain references to whitelisted URLs. An attacker could exploit this vulnerability by sending a malicious email message that contains a large number of whitelisted URLs. A successful exploit could allow the attacker to cause a sustained DoS condition that could force the affected device to stop scanning and forwarding email messages.

Cisco has released software updates that address this vulnerability. There are workarounds that address this vulnerability.

This advisory is available at the following link:
https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190109-esa-url-dos ["https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190109-esa-url-dos"]</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="2">This vulnerability affects all software versions prior to the first fixed release of Cisco AsyncOS Software for Cisco ESAs, both virtual and hardware, if the URL Filtering as Global Setting feature is enabled and a URL whitelist is in use. By default, the URL Filtering as Global Setting feature is disabled.

To determine whether a vulnerable release of Cisco AsyncOS Software is running on an ESA, administrators can use the version command in the ESA CLI. The following example shows the output of the command for an ESA that is running Cisco AsyncOS Software Release 10.0.1-087:
ciscoesa&gt; version
  Current Version  ===============  Product: Cisco C100V Email Security Virtual Appliance
Model: C100V
Version: 10.0.1-087
.  .  .


To check whether a Cisco ESA is configured with URL Filtering and uses a URL whitelist, administrators can navigate to GUI &gt; Security Services &gt; URL Filtering. A vulnerable device will have URL Category and Reputation Filters set to Enabled and URL whitelist set to any value other than  None.</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="3">Only products listed in the Vulnerable Products ["#vp"] section of this advisory are known to be affected by this vulnerability.

Cisco has confirmed that this vulnerability does not affect the following products:

Content Security Management Appliance, virtual and hardware versions
Web Security Appliance, virtual and hardware versions</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="4">There are two possible workarounds to address this vulnerability:

1. If the whitelist through Global URL Filtering is not needed, administrators can disable it by following these steps:

On the ESA, navigate to Security Services &gt; URL Filtering.
Click on Edit Global Settings and set Use a URL whitelist to None. This disables the global whitelist.
Commit the Changes.

  2. If the whitelist through Global URL Filtering feature is needed, the same level of filtering can be achieved by implementing a single whitelist per Content Filter, after disabling the whitelist through Global URL Filtering, as described in step 1. Administrators can choose a specific URL Reputation range or set of URL Categories to apply the whitelist to via the Content Filter. The required steps are as follows:

On the ESA, navigate to Mail Policies &gt; Incoming Content Filters
[Optionally] Create a new Content Filter by clicking Add Filter
Click on the desired Content Filter &gt; Add Action &gt; URL Reputation &gt; Select Custom Range

Input the desired range
[Alternatively] Add Action &gt; URL Categories &gt; Add desired Categories set
Choose the desired whitelist
Click OK &gt; Submit
Commit the Changes</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="5">Cisco has released free software updates that address the vulnerability described in this advisory. Customers may only install and expect support for software versions and feature sets for which they have purchased a license. By installing, downloading, accessing, or otherwise using such software upgrades, customers agree to follow the terms of the Cisco software license:
https://www.cisco.com/c/en/us/products/end-user-license-agreement.html ["https://www.cisco.com/c/en/us/products/end-user-license-agreement.html"]

Additionally, customers may only download software for which they have a valid license, procured from Cisco directly, or through a Cisco authorized reseller or partner. In most cases this will be a maintenance upgrade to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

When considering software upgrades, customers are advised to regularly consult the advisories for Cisco products, which are available from the Cisco Security Advisories and Alerts page ["https://www.cisco.com/go/psirt"], to determine exposure and a complete upgrade solution.

In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.

Customers Without Service Contracts

Customers who purchase directly from Cisco but do not hold a Cisco service contract and customers who make purchases through third-party vendors but are unsuccessful in obtaining fixed software through their point of sale should obtain upgrades by contacting the Cisco TAC:
https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html ["https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html"]

Customers should have the product serial number available and be prepared to provide the URL of this advisory as evidence of entitlement to a free upgrade.

Fixed Releases

In the following table, the left column lists major releases of Cisco AsyncOS Software for ESA. The right column indicates whether a major release is affected by the vulnerability described in this advisory and the first minor release that includes the fix for this vulnerability.

Customers should upgrade to an appropriate release as indicated in the following table:
                                Cisco AsyncOS Software for ESA Major Release              First Fixed Release for This Vulnerability                                   Prior to 9.0               Affected; Migrate to 11.0.2-044 MD
                                   9.x               Affected; Migrate to 11.0.2-044 MD
                                   10.x               Affected; Migrate to 11.0.2-044 MD
                                   11.0.x               11.0.2-044 MD1
                                   11.1.x               11.1.2-023 MD2
                                   12.x               Not affected

1 11.0.2-044 will run on all legacy hardware for ESA models x70, x80, x90 and the virtual appliances.
2 11.1.2-023 will run on ESA models x80, x90 and the virtual appliances.

Note that Cisco provides regular maintenance of products in the Cisco  Cloud Email Security (CES) service solution, which includes Cisco Email  Security Appliances and Cisco Content Security Management Appliances.  Customers can also request a software upgrade by contacting Cisco TAC.</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="6">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy ["http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="7">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory.</cvrf:Note>
    <cvrf:Note Title="Source" Type="General" Ordinal="8">This vulnerability was found during the resolution of a Cisco TAC support case.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="9">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190109-esa-url-dos</cvrf:URL>
      <cvrf:Description>Cisco Email Security Appliance URL Filtering Denial of Service Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Email Security Appliance (ESA)" Type="Product Name">
        <FullProductName ProductID="CVRFPID-189790">Cisco Email Security Appliance (ESA) </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco Email Security Appliance URL Filtering Denial of Service Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCvm81627</ID>
    <Notes>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="1">CSCvm81627</Note>
    </Notes>
    <CVE>CVE-2018-15460</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-189790</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV3>
        <BaseScoreV3>8.6</BaseScoreV3>
        <VectorV3>CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H</VectorV3>
      </ScoreSetV3>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>There are two possible workarounds to address this vulnerability:

1. If the whitelist through Global URL Filtering is not needed, administrators can disable it by following these steps:

On the ESA, navigate to Security Services &gt; URL Filtering.
Click on Edit Global Settings and set Use a URL whitelist to None. This disables the global whitelist.
Commit the Changes.

  2. If the whitelist through Global URL Filtering feature is needed, the same level of filtering can be achieved by implementing a single whitelist per Content Filter, after disabling the whitelist through Global URL Filtering, as described in step 1. Administrators can choose a specific URL Reputation range or set of URL Categories to apply the whitelist to via the Content Filter. The required steps are as follows:

On the ESA, navigate to Mail Policies &gt; Incoming Content Filters
[Optionally] Create a new Content Filter by clicking Add Filter
Click on the desired Content Filter &gt; Add Action &gt; URL Reputation &gt; Select Custom Range

Input the desired range
[Alternatively] Add Action &gt; URL Categories &gt; Add desired Categories set
Choose the desired whitelist
Click OK &gt; Submit
Commit the Changes</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190109-esa-url-dos</URL>
        <Description>Cisco Email Security Appliance URL Filtering Denial of Service Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>