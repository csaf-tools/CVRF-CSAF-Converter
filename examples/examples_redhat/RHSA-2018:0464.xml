<?xml version="1.0" encoding="utf-8"?>
<cvrfdoc xmlns="http://www.icasi.org/CVRF/schema/cvrf/1.1" xmlns:cvrf="http://www.icasi.org/CVRF/schema/cvrf/1.1">
  <DocumentTitle xml:lang="en">Red Hat Security Advisory: kernel security and bug fix update</DocumentTitle>
  <DocumentType>Security Advisory</DocumentType>
  <DocumentPublisher Type="Vendor">
    <ContactDetails>secalert@redhat.com</ContactDetails>
    <IssuingAuthority>Red Hat Product Security</IssuingAuthority>
  </DocumentPublisher>
  <DocumentTracking>
    <Identification><ID>RHSA-2018:0464</ID></Identification>
    <Status>Final</Status>
    <Version>1</Version>
    <RevisionHistory>
       <Revision>
         <Number>1</Number>
         <Date>2021-07-20T15:21:00Z</Date>
         <Description>Current version</Description>
       </Revision>
    </RevisionHistory>
    <InitialReleaseDate>2018-03-07T15:23:00Z</InitialReleaseDate>
    <CurrentReleaseDate>2021-07-20T15:21:00Z</CurrentReleaseDate>
    <Generator>
      <Engine>Red Hat SDEngine 3.0.0</Engine>
      <Date>2021-08-23T04:52:00Z</Date>
    </Generator>
  </DocumentTracking>
  <DocumentNotes>
    <Note Title="Topic" Type="Summary" Ordinal="1" xml:lang="en">
An update for kernel is now available for Red Hat Enterprise Linux 5.9 Long Life.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.
    </Note>
    <Note Title="Details" Type="General" Ordinal="2" xml:lang="en">
The kernel packages contain the Linux kernel, the core of any Linux operating system.

Security Fix(es):

An industry-wide issue was found in the way many modern microprocessor designs have implemented speculative execution of instructions (a commonly used performance optimization). There are three primary variants of the issue which differ in the way the speculative execution can be exploited.

Note: This issue is present in hardware and cannot be fully fixed via software update. The updated kernel packages provide software mitigation for this hardware issue at a cost of potential performance penalty. Please refer to References section for further information about this issue and the performance impact.

In this update mitigations for x86-64 architecture are provided.

* Variant CVE-2017-5753 triggers the speculative execution by performing a bounds-check bypass. It relies on the presence of a precisely-defined instruction sequence in the privileged code as well as the fact that memory accesses may cause allocation into the microprocessor's data cache even for speculatively executed instructions that never actually commit (retire). As a result, an unprivileged attacker could use this flaw to cross the syscall boundary and read privileged memory by conducting targeted cache side-channel attacks. (CVE-2017-5753, Important)

* Variant CVE-2017-5754 relies on the fact that, on impacted microprocessors, during speculative execution of instruction permission faults, exception generation triggered by a faulting access is suppressed until the retirement of the whole instruction block. In a combination with the fact that memory accesses may populate the cache even when the block is being dropped and never committed (executed), an unprivileged local attacker could use this flaw to read privileged (kernel space) memory by conducting targeted cache side-channel attacks. (CVE-2017-5754, Important)

Red Hat would like to thank Google Project Zero for reporting these issues.

Bug Fix(es):

* Previously, the page table isolation feature was able to modify the kernel Page Global Directory (PGD) entries with the _NX bit even for CPUs without the capability to use the &quot;no execute&quot; (NX) bit technology. Consequently, the page tables got corrupted, and the kernel panicked at the first page-fault occurrence. This update adds the check of CPU capabilities before modifying kernel PGD entries with _NX. As a result, the operating system no longer panics on boot due to corrupted page tables under the described circumstances. (BZ#1538169)

* When booting the operating system with the Kernel Page Table Isolation option enabled, the HPET VSYSCALL shadow mapping was not placed correctly. Consequently, the High Precision Event Timer (HPET) feature was not available early enough, and warnings on boot time occurred. This update fixes the placement of HPET VSYSCALL, and the warnings on boot time due to this behavior no longer occur. (BZ#1541281)

* Previously, the routine preparing the kexec crashkernel area did not properly clear the page allocated to be kexec's Page Global Directory (PGD). Consequently, the page table isolation shadow mapping routines failed with a warning message when setting up page table entries. With this update, the underlying source code has been fixed to clear the kexec PGD allocated page before setting up its page table entries. As a result, warnings are no longer issued when setting up kexec. (BZ#1541285)

* When changing a kernel page mapping from Read Only (RO) to Read Write (RW), the Translation Lookaside Buffer (TLB) entry was previously not updated. Consequently, a protection fault on a write operation occurred, which led to a kernel panic. With this update, the underlying source code has been fixed to handle such kind of fault properly, and the kernel no longer panics in the described situation. (BZ#1541892)
    </Note>
    <Note Title="Terms of Use" Ordinal="3" Type="Legal Disclaimer" xml:lang="en">This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.</Note>
  </DocumentNotes>
  <DocumentDistribution xml:lang="en">Copyright Â© 2021 Red Hat, Inc. All rights reserved.</DocumentDistribution>
  <AggregateSeverity Namespace="https://access.redhat.com/security/updates/classification/">Important</AggregateSeverity>
  <DocumentReferences>
    <Reference Type="Self">
       <URL>https://access.redhat.com/errata/RHSA-2018:0464</URL>
       <Description>https://access.redhat.com/errata/RHSA-2018:0464</Description>
    </Reference>
    <Reference Type="External">
       <URL>https://access.redhat.com/security/updates/classification/#important</URL>
       <Description>https://access.redhat.com/security/updates/classification/#important</Description>
    </Reference>
    <Reference Type="External">
       <URL>https://access.redhat.com/security/vulnerabilities/speculativeexecution</URL>
       <Description>https://access.redhat.com/security/vulnerabilities/speculativeexecution</Description>
    </Reference>
    <Reference Type="External">
       <URL>https://access.redhat.com/security/cve/CVE-2017-5753</URL>
       <Description>https://access.redhat.com/security/cve/CVE-2017-5753</Description>
    </Reference>
    <Reference Type="External">
       <URL>https://access.redhat.com/security/cve/CVE-2017-5754</URL>
       <Description>https://access.redhat.com/security/cve/CVE-2017-5754</Description>
    </Reference>
  </DocumentReferences>
  <ProductTree xmlns="http://www.icasi.org/CVRF/schema/prod/1.1">
    <Branch Type="Product Family" Name="Red Hat Enterprise Linux">
      <Branch Type="Product Name" Name="Red Hat Enterprise Linux Long Life (v. 5.9 server)">
        <FullProductName ProductID="5Server-5.9.AUS" CPE="cpe:/o:redhat:rhel_aus:5.9">Red Hat Enterprise Linux Long Life (v. 5.9 server)</FullProductName>
      </Branch>
    </Branch>
    <Branch Type="Product Version" Name="kernel-0:2.6.18-348.35.1.el5">
      <FullProductName ProductID="kernel-0:2.6.18-348.35.1.el5" CPE="cpe:/o:redhat:rhel_aus:5.9">kernel-2.6.18-348.35.1.el5.src.rpm</FullProductName>
    </Branch>
    <Relationship ProductReference="kernel-0:2.6.18-348.35.1.el5" RelationType="Default Component Of" RelatesToProductReference="5Server-5.9.AUS">
      <FullProductName ProductID="5Server-5.9.AUS:kernel-0:2.6.18-348.35.1.el5" CPE="cpe:/o:redhat:rhel_aus:5.9">kernel-0:2.6.18-348.35.1.el5 as a component of Red Hat Enterprise Linux Long Life (v. 5.9 server)</FullProductName>
    </Relationship>
  </ProductTree>

  <Vulnerability Ordinal="1" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">hw: cpu: speculative execution bounds-check bypass</Note></Notes>
    <DiscoveryDate>2017-11-30T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2018-01-03T22:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2017-5753</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>5Server-5.9.AUS:kernel-0:2.6.18-348.35.1.el5</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Important</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
For details on how to apply this update, which includes the changes described in this advisory, refer to:

https://access.redhat.com/articles/11258

The system must be rebooted for this update to take effect.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2018:0464</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/vulnerabilities/speculativeexecution</URL>
        <Description>https://access.redhat.com/security/vulnerabilities/speculativeexecution</Description>
      </Reference>
      <Reference>
        <URL>https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html</URL>
        <Description>https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html</Description>
      </Reference>
      <Reference>
        <URL>https://meltdownattack.com</URL>
        <Description>https://meltdownattack.com</Description>
      </Reference>
      <Reference>
        <URL>https://spectreattack.com/</URL>
        <Description>https://spectreattack.com/</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2017-5753</URL>
        <Description>CVE-2017-5753</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1519778</URL>
        <Description>bz#1519778: CVE-2017-5753 hw: cpu: speculative execution bounds-check bypass</Description>
      </Reference>
    </References>
    <Acknowledgments><Acknowledgment><Description>Red Hat would like to thank Google Project Zero for reporting this issue.</Description></Acknowledgment></Acknowledgments>
  </Vulnerability>

  <Vulnerability Ordinal="2" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">hw: cpu: speculative execution permission faults handling</Note></Notes>
    <DiscoveryDate>2017-11-30T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2018-01-03T22:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2017-5754</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>5Server-5.9.AUS:kernel-0:2.6.18-348.35.1.el5</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Important</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
For details on how to apply this update, which includes the changes described in this advisory, refer to:

https://access.redhat.com/articles/11258

The system must be rebooted for this update to take effect.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2018:0464</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html</URL>
        <Description>https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html</Description>
      </Reference>
      <Reference>
        <URL>https://meltdownattack.com</URL>
        <Description>https://meltdownattack.com</Description>
      </Reference>
      <Reference>
        <URL>https://spectreattack.com/</URL>
        <Description>https://spectreattack.com/</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2017-5754</URL>
        <Description>CVE-2017-5754</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1519781</URL>
        <Description>bz#1519781: CVE-2017-5754 hw: cpu: speculative execution permission faults handling</Description>
      </Reference>
    </References>
    <Acknowledgments><Acknowledgment><Description>Red Hat would like to thank Google Project Zero for reporting this issue.</Description></Acknowledgment></Acknowledgments>
  </Vulnerability>
</cvrfdoc>
