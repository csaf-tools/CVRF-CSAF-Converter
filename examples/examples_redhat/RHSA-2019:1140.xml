<?xml version="1.0" encoding="utf-8"?>
<cvrfdoc xmlns="http://www.icasi.org/CVRF/schema/cvrf/1.1" xmlns:cvrf="http://www.icasi.org/CVRF/schema/cvrf/1.1">
  <DocumentTitle xml:lang="en">Red Hat Security Advisory: Red Hat Single Sign-On 7.3.1 security update</DocumentTitle>
  <DocumentType>Security Advisory</DocumentType>
  <DocumentPublisher Type="Vendor">
    <ContactDetails>secalert@redhat.com</ContactDetails>
    <IssuingAuthority>Red Hat Product Security</IssuingAuthority>
  </DocumentPublisher>
  <DocumentTracking>
    <Identification><ID>RHSA-2019:1140</ID></Identification>
    <Status>Final</Status>
    <Version>2</Version>
    <RevisionHistory>
       <Revision>
         <Number>2</Number>
         <Date>2021-07-07T21:10:00Z</Date>
         <Description>Current version</Description>
       </Revision>
    </RevisionHistory>
    <InitialReleaseDate>2019-05-09T18:14:00Z</InitialReleaseDate>
    <CurrentReleaseDate>2021-07-07T21:10:00Z</CurrentReleaseDate>
    <Generator>
      <Engine>Red Hat SDEngine 3.0.0</Engine>
      <Date>2021-08-23T04:41:00Z</Date>
    </Generator>
  </DocumentTracking>
  <DocumentNotes>
    <Note Title="Topic" Type="Summary" Ordinal="1" xml:lang="en">
A security update is now available for Red Hat Single Sign-On 7.3 from the Customer Portal.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

[2021-07-07 UPDATE: The advisory was originally published with incomplete informational links and has been republished to update those links. NO CODE HAS CHANGED WITH THIS UPDATE, AND NO ACTION IS REQUIRED.]
    </Note>
    <Note Title="Details" Type="General" Ordinal="2" xml:lang="en">
Red Hat Single Sign-On 7.3 is a standalone server, based on the Keycloak project, that provides authentication and standards-based single sign-on capabilities for web and mobile applications.

This release of Red Hat Single Sign-On 7.3.1 serves as a replacement for Red Hat Single Sign-On 7.3.0, and includes bug fixes and enhancements, which are documented in the Release Notes document linked to in the References.

Security Fix(es):

* keycloak: session hijack using the user access token (CVE-2019-3868)

* jackson-databind: Potential information exfiltration with default typing, serialization gadget from MyBatis (CVE-2018-11307)

* jackson-databind: improper polymorphic deserialization of types from Jodd-db library (CVE-2018-12022)

* jackson-databind: improper polymorphic deserialization of types from Oracle JDBC driver (CVE-2018-12023)

* undertow: Infoleak in some circumstances where Undertow can serve data from a random buffer (CVE-2018-14642)

* jackson-databind: exfiltration/XXE in some JDK classes (CVE-2018-14720)

* jackson-databind: server-side request forgery (SSRF) in axis2-jaxws class (CVE-2018-14721)

* wildfly: Race condition on PID file allows for termination of arbitrary processes by local users (CVE-2019-3805)

* wildfly: wrong SecurityIdentity for EE concurrency threads that are reused (CVE-2019-3894)

For more details about the security issue(s), including the impact, a CVSS score, and other related information, refer to the CVE page(s) listed in the References section.
    </Note>
    <Note Title="Terms of Use" Ordinal="3" Type="Legal Disclaimer" xml:lang="en">This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.</Note>
  </DocumentNotes>
  <DocumentDistribution xml:lang="en">Copyright Â© 2021 Red Hat, Inc. All rights reserved.</DocumentDistribution>
  <AggregateSeverity Namespace="https://access.redhat.com/security/updates/classification/">Important</AggregateSeverity>
  <DocumentReferences>
    <Reference Type="Self">
       <URL>https://access.redhat.com/errata/RHSA-2019:1140</URL>
       <Description>https://access.redhat.com/errata/RHSA-2019:1140</Description>
    </Reference>
    <Reference Type="External">
       <URL>https://access.redhat.com/security/updates/classification/#important</URL>
       <Description>https://access.redhat.com/security/updates/classification/#important</Description>
    </Reference>
    <Reference Type="External">
       <URL>https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?downloadType=securityPatches&amp;product=core.service.rhsso&amp;version=7.3</URL>
       <Description>https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?downloadType=securityPatches&amp;product=core.service.rhsso&amp;version=7.3</Description>
    </Reference>
    <Reference Type="External">
       <URL>https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.3/</URL>
       <Description>https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.3/</Description>
    </Reference>
  </DocumentReferences>

  <Vulnerability Ordinal="1" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">jackson-databind: Potential information exfiltration with default typing, serialization gadget from MyBatis</Note></Notes>
    <DiscoveryDate>2019-02-14T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2018-05-10T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2018-11307</CVE>
    <Threats><Threat Type="Impact"><Description>Important</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
Before applying the update, back up your existing installation, including all applications, configuration files, databases and database settings, and so on.

The References section of this erratum contains a download link (you must log in to download the update).
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2019:1140</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2018-11307</URL>
        <Description>CVE-2018-11307</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1677341</URL>
        <Description>bz#1677341: CVE-2018-11307 jackson-databind: Potential information exfiltration with default typing, serialization gadget from MyBatis</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="2" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">jackson-databind: improper polymorphic deserialization of types from Jodd-db library</Note></Notes>
    <DiscoveryDate>2019-01-16T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2018-05-29T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2018-12022</CVE>
    <Threats><Threat Type="Impact"><Description>Important</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
Before applying the update, back up your existing installation, including all applications, configuration files, databases and database settings, and so on.

The References section of this erratum contains a download link (you must log in to download the update).
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2019:1140</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2018-12022</URL>
        <Description>CVE-2018-12022</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1671097</URL>
        <Description>bz#1671097: CVE-2018-12022 jackson-databind: improper polymorphic deserialization of types from Jodd-db library</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="3" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">jackson-databind: improper polymorphic deserialization of types from Oracle JDBC driver</Note></Notes>
    <DiscoveryDate>2019-01-16T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2018-06-08T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2018-12023</CVE>
    <Threats><Threat Type="Impact"><Description>Important</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
Before applying the update, back up your existing installation, including all applications, configuration files, databases and database settings, and so on.

The References section of this erratum contains a download link (you must log in to download the update).
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2019:1140</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2018-12023</URL>
        <Description>CVE-2018-12023</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1671096</URL>
        <Description>bz#1671096: CVE-2018-12023 jackson-databind: improper polymorphic deserialization of types from Oracle JDBC driver</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="4" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">undertow: Infoleak in some circumstances where Undertow can serve data from a random buffer</Note></Notes>
    <DiscoveryDate>2018-09-13T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2018-09-14T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2018-14642</CVE>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
Before applying the update, back up your existing installation, including all applications, configuration files, databases and database settings, and so on.

The References section of this erratum contains a download link (you must log in to download the update).
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2019:1140</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2018-14642</URL>
        <Description>CVE-2018-14642</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1628702</URL>
        <Description>bz#1628702: CVE-2018-14642 undertow: Infoleak in some circumstances where Undertow can serve data from a random buffer</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="5" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">jackson-databind: exfiltration/XXE in some JDK classes</Note></Notes>
    <DiscoveryDate>2019-01-02T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2018-07-27T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2018-14720</CVE>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
Before applying the update, back up your existing installation, including all applications, configuration files, databases and database settings, and so on.

The References section of this erratum contains a download link (you must log in to download the update).
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2019:1140</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2018-14720</URL>
        <Description>CVE-2018-14720</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1666423</URL>
        <Description>bz#1666423: CVE-2018-14720 jackson-databind: exfiltration/XXE in some JDK classes</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="6" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">jackson-databind: server-side request forgery (SSRF) in axis2-jaxws class</Note></Notes>
    <DiscoveryDate>2019-01-02T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2018-07-27T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2018-14721</CVE>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
Before applying the update, back up your existing installation, including all applications, configuration files, databases and database settings, and so on.

The References section of this erratum contains a download link (you must log in to download the update).
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2019:1140</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2018-14721</URL>
        <Description>CVE-2018-14721</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1666428</URL>
        <Description>bz#1666428: CVE-2018-14721 jackson-databind: server-side request forgery (SSRF) in axis2-jaxws class</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="7" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">wildfly: Race condition on PID file allows for termination of arbitrary processes by local users</Note></Notes>
    <DiscoveryDate>2018-11-01T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2019-04-30T17:12:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2019-3805</CVE>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
Before applying the update, back up your existing installation, including all applications, configuration files, databases and database settings, and so on.

The References section of this erratum contains a download link (you must log in to download the update).
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2019:1140</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2019-3805</URL>
        <Description>CVE-2019-3805</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1660263</URL>
        <Description>bz#1660263: CVE-2019-3805 wildfly: Race condition on PID file allows for termination of arbitrary processes by local users</Description>
      </Reference>
    </References>
    <Acknowledgments><Acknowledgment><Description>Red Hat would like to thank Daniel Le Gall (SCRT Information Security) for reporting this issue.</Description></Acknowledgment></Acknowledgments>
  </Vulnerability>

  <Vulnerability Ordinal="8" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">keycloak: session hijack using the user access token</Note></Notes>
    <DiscoveryDate>2019-02-20T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2019-04-23T16:59:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2019-3868</CVE>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
Before applying the update, back up your existing installation, including all applications, configuration files, databases and database settings, and so on.

The References section of this erratum contains a download link (you must log in to download the update).
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2019:1140</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2019-3868</URL>
        <Description>CVE-2019-3868</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1679144</URL>
        <Description>bz#1679144: CVE-2019-3868 keycloak: session hijack using the user access token</Description>
      </Reference>
    </References>
    <Acknowledgments><Acknowledgment><Description>Red Hat would like to thank Caranzo Gideon (Gemalto E&amp;C), Muzamil Muein (Gemalto E&amp;C), and Siddiqui Najam (Gemalto E&amp;C) for reporting this issue.</Description></Acknowledgment></Acknowledgments>
  </Vulnerability>

  <Vulnerability Ordinal="9" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">wildfly: wrong SecurityIdentity for EE concurrency threads that are reused</Note></Notes>
    <DiscoveryDate>2019-02-22T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2019-04-30T17:11:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2019-3894</CVE>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
Before applying the update, back up your existing installation, including all applications, configuration files, databases and database settings, and so on.

The References section of this erratum contains a download link (you must log in to download the update).
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2019:1140</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2019-3894</URL>
        <Description>CVE-2019-3894</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1682108</URL>
        <Description>bz#1682108: CVE-2019-3894 wildfly: wrong SecurityIdentity for EE concurrency threads that are reused</Description>
      </Reference>
    </References>
    <Acknowledgments><Acknowledgment><Description>This issue was discovered by James Perkins (Red Hat).</Description></Acknowledgment></Acknowledgments>
  </Vulnerability>
</cvrfdoc>
