<?xml version="1.0" encoding="utf-8"?>
<cvrfdoc xmlns="http://www.icasi.org/CVRF/schema/cvrf/1.1" xmlns:cvrf="http://www.icasi.org/CVRF/schema/cvrf/1.1">
  <DocumentTitle xml:lang="en">Red Hat Security Advisory: nss and nspr security, bug fix, and enhancement update</DocumentTitle>
  <DocumentType>Security Advisory</DocumentType>
  <DocumentPublisher Type="Vendor">
    <ContactDetails>secalert@redhat.com</ContactDetails>
    <IssuingAuthority>Red Hat Product Security</IssuingAuthority>
  </DocumentPublisher>
  <DocumentTracking>
    <Identification><ID>RHSA-2020:3280</ID></Identification>
    <Status>Final</Status>
    <Version>1</Version>
    <RevisionHistory>
       <Revision>
         <Number>1</Number>
         <Date>2021-11-10T19:14:00Z</Date>
         <Description>Current version</Description>
       </Revision>
    </RevisionHistory>
    <InitialReleaseDate>2020-08-03T13:04:00Z</InitialReleaseDate>
    <CurrentReleaseDate>2021-11-10T19:14:00Z</CurrentReleaseDate>
    <Generator>
      <Engine>Red Hat SDEngine 3.3.0</Engine>
      <Date>2021-11-13T18:42:00Z</Date>
    </Generator>
  </DocumentTracking>
  <DocumentNotes>
    <Note Title="Topic" Type="Summary" Ordinal="1" xml:lang="en">
An update for nss and nspr is now available for Red Hat Enterprise Linux 8.

Red Hat Product Security has rated this update as having a security impact of Moderate. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.
    </Note>
    <Note Title="Details" Type="General" Ordinal="2" xml:lang="en">
Network Security Services (NSS) is a set of libraries designed to support the cross-platform development of security-enabled client and server applications.

Netscape Portable Runtime (NSPR) provides platform independence for non-GUI operating system facilities.

The following packages have been upgraded to a later upstream version: nss (3.53.1), nspr (4.25.0). (BZ#1809549, BZ#1809550)

Security Fix(es):

* nss: UAF in sftk_FreeSession due to improper refcounting (CVE-2019-11756)

* nss: Check length of inputs for cryptographic primitives (CVE-2019-17006)

* nss: Side channel vulnerabilities during RSA key generation (CVE-2020-12402)

* nss: TLS 1.3 HelloRetryRequest downgrade request sets client into invalid state (CVE-2019-17023)

For more details about the security issue(s), including the impact, a CVSS score, acknowledgments, and other related information, refer to the CVE page(s) listed in the References section.

Bug Fix(es):

* Install of update of nss.x86_64 adds i686 into transaction (BZ#1663187)

* NSS does not set downgrade sentinel in ServerHello.random for TLS 1.0 and TLS 1.1 (BZ#1691409)

* TLS Keying Material Exporter is unsupported by command line tools (BZ#1691454)

* TLS_AES_256_GCM_SHA384 is not marked as FIPS compatible (BZ#1711375)

* Make TLS 1.3 work in FIPS mode (BZ#1724250)

* NSS rejects records with large padding with SHA384 HMAC (BZ#1750921)

* NSS missing IKEv1 Quick Mode KDF (BZ#1809637)

* Name Constraints validation: CN treated as DNS name even when syntactically invalid as DNS name (BZ#1825270)

* FIPS needs nss to restrict valid dh primes to those primes that are approved. (BZ#1854564)

* nss needs to comply to the new SP800-56A rev 3 requirements (BZ#1855825)

Enhancement(s):

* [RFE] nss should use AES for storage of keys (BZ#1723819)
    </Note>
    <Note Title="Terms of Use" Ordinal="3" Type="Legal Disclaimer" xml:lang="en">This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.</Note>
  </DocumentNotes>
  <DocumentDistribution xml:lang="en">Copyright Â© 2021 Red Hat, Inc. All rights reserved.</DocumentDistribution>
  <AggregateSeverity Namespace="https://access.redhat.com/security/updates/classification/">Moderate</AggregateSeverity>
  <DocumentReferences>
    <Reference Type="Self">
       <URL>https://access.redhat.com/errata/RHSA-2020:3280</URL>
       <Description>https://access.redhat.com/errata/RHSA-2020:3280</Description>
    </Reference>
    <Reference Type="External">
       <URL>https://access.redhat.com/security/updates/classification/#moderate</URL>
       <Description>https://access.redhat.com/security/updates/classification/#moderate</Description>
    </Reference>
  </DocumentReferences>
  <ProductTree xmlns="http://www.icasi.org/CVRF/schema/prod/1.1">
    <Branch Type="Product Family" Name="Red Hat Enterprise Linux">
      <Branch Type="Product Name" Name="Red Hat Enterprise Linux AppStream (v. 8)">
        <FullProductName ProductID="AppStream-8.2.0.Z.MAIN.EUS" CPE="cpe:/a:redhat:enterprise_linux:8::appstream">Red Hat Enterprise Linux AppStream (v. 8)</FullProductName>
      </Branch>
    </Branch>
    <Branch Type="Product Version" Name="nspr-0:4.25.0-2.el8_2">
      <FullProductName ProductID="nspr-0:4.25.0-2.el8_2" CPE="cpe:/a:redhat:enterprise_linux:8::appstream">nspr-4.25.0-2.el8_2.src.rpm</FullProductName>
    </Branch>
    <Branch Type="Product Version" Name="nss-0:3.53.1-11.el8_2">
      <FullProductName ProductID="nss-0:3.53.1-11.el8_2" CPE="cpe:/a:redhat:enterprise_linux:8::appstream">nss-3.53.1-11.el8_2.src.rpm</FullProductName>
    </Branch>
    <Relationship ProductReference="nspr-0:4.25.0-2.el8_2" RelationType="Default Component Of" RelatesToProductReference="AppStream-8.2.0.Z.MAIN.EUS">
      <FullProductName ProductID="AppStream-8.2.0.Z.MAIN.EUS:nspr-0:4.25.0-2.el8_2" CPE="cpe:/a:redhat:enterprise_linux:8::appstream">nspr-0:4.25.0-2.el8_2 as a component of Red Hat Enterprise Linux AppStream (v. 8)</FullProductName>
    </Relationship>
    <Relationship ProductReference="nss-0:3.53.1-11.el8_2" RelationType="Default Component Of" RelatesToProductReference="AppStream-8.2.0.Z.MAIN.EUS">
      <FullProductName ProductID="AppStream-8.2.0.Z.MAIN.EUS:nss-0:3.53.1-11.el8_2" CPE="cpe:/a:redhat:enterprise_linux:8::appstream">nss-0:3.53.1-11.el8_2 as a component of Red Hat Enterprise Linux AppStream (v. 8)</FullProductName>
    </Relationship>
  </ProductTree>

  <Vulnerability Ordinal="1" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">nss: Use-after-free in sftk_FreeSession due to improper refcounting</Note></Notes>
    <DiscoveryDate>2019-11-21T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2019-12-10T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2019-11756</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>AppStream-8.2.0.Z.MAIN.EUS:nspr-0:4.25.0-2.el8_2</ProductID>
      <ProductID>AppStream-8.2.0.Z.MAIN.EUS:nss-0:3.53.1-11.el8_2</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
For details on how to apply this update, which includes the changes described in this advisory, refer to:

https://access.redhat.com/articles/11258

After installing this update, applications using NSS (for example, Firefox) must be restarted for this update to take effect. After installing this update, applications using NSPR (for example, Firefox) must be restarted for this update to take effect.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2020:3280</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.47_release_notes</URL>
        <Description>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.47_release_notes</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2019-11756</URL>
        <Description>CVE-2019-11756</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1774835</URL>
        <Description>bz#1774835: CVE-2019-11756 nss: Use-after-free in sftk_FreeSession due to improper refcounting</Description>
      </Reference>
    </References>
    <Acknowledgments><Acknowledgment><Description>Red Hat would like to thank the Mozilla project for reporting this issue.</Description></Acknowledgment></Acknowledgments>
  </Vulnerability>

  <Vulnerability Ordinal="2" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">nss: Check length of inputs for cryptographic primitives</Note></Notes>
    <DiscoveryDate>2019-11-23T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2019-12-26T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2019-17006</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>AppStream-8.2.0.Z.MAIN.EUS:nspr-0:4.25.0-2.el8_2</ProductID>
      <ProductID>AppStream-8.2.0.Z.MAIN.EUS:nss-0:3.53.1-11.el8_2</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
For details on how to apply this update, which includes the changes described in this advisory, refer to:

https://access.redhat.com/articles/11258

After installing this update, applications using NSS (for example, Firefox) must be restarted for this update to take effect. After installing this update, applications using NSPR (for example, Firefox) must be restarted for this update to take effect.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2020:3280</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.46_release_notes</URL>
        <Description>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.46_release_notes</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2019-17006</URL>
        <Description>CVE-2019-17006</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1775916</URL>
        <Description>bz#1775916: CVE-2019-17006 nss: Check length of inputs for cryptographic primitives</Description>
      </Reference>
    </References>
    <Acknowledgments><Acknowledgment><Description>Red Hat would like to thank the Mozilla Project for reporting this issue.</Description></Acknowledgment></Acknowledgments>
  </Vulnerability>

  <Vulnerability Ordinal="3" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">nss: TLS 1.3 HelloRetryRequest downgrade request sets client into invalid state</Note></Notes>
    <DiscoveryDate>2020-01-15T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2020-01-08T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2019-17023</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>AppStream-8.2.0.Z.MAIN.EUS:nspr-0:4.25.0-2.el8_2</ProductID>
      <ProductID>AppStream-8.2.0.Z.MAIN.EUS:nss-0:3.53.1-11.el8_2</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Low</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
For details on how to apply this update, which includes the changes described in this advisory, refer to:

https://access.redhat.com/articles/11258

After installing this update, applications using NSS (for example, Firefox) must be restarted for this update to take effect. After installing this update, applications using NSPR (for example, Firefox) must be restarted for this update to take effect.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2020:3280</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.49_release_notes</URL>
        <Description>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.49_release_notes</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2019-17023</URL>
        <Description>CVE-2019-17023</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1791225</URL>
        <Description>bz#1791225: CVE-2019-17023 nss: TLS 1.3 HelloRetryRequest downgrade request sets client into invalid state</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="4" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">nss: Timing attack on DSA signature generation</Note></Notes>
    <DiscoveryDate>2020-04-20T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2020-05-21T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2020-12399</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>AppStream-8.2.0.Z.MAIN.EUS:nspr-0:4.25.0-2.el8_2</ProductID>
      <ProductID>AppStream-8.2.0.Z.MAIN.EUS:nss-0:3.53.1-11.el8_2</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
For details on how to apply this update, which includes the changes described in this advisory, refer to:

https://access.redhat.com/articles/11258

After installing this update, applications using NSS (for example, Firefox) must be restarted for this update to take effect. After installing this update, applications using NSPR (for example, Firefox) must be restarted for this update to take effect.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2020:3280</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.44.4_release_notes</URL>
        <Description>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.44.4_release_notes</Description>
      </Reference>
      <Reference>
        <URL>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.52.1_release_notes</URL>
        <Description>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.52.1_release_notes</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2020-12399</URL>
        <Description>CVE-2020-12399</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1826177</URL>
        <Description>bz#1826177: CVE-2020-12399 nss: Timing attack on DSA signature generation</Description>
      </Reference>
    </References>
    <Acknowledgments><Acknowledgment><Description>Red Hat would like to thank the Mozilla Project for reporting this issue. Upstream acknowledges  (Tampere University) and Cesar Pereida Garcia and the Network and Information Security Group (NISEC) as the original reporters.</Description></Acknowledgment></Acknowledgments>
  </Vulnerability>

  <Vulnerability Ordinal="5" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">nss: Side channel vulnerabilities during RSA key generation</Note></Notes>
    <DiscoveryDate>2020-04-20T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2020-06-02T12:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2020-12402</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>AppStream-8.2.0.Z.MAIN.EUS:nspr-0:4.25.0-2.el8_2</ProductID>
      <ProductID>AppStream-8.2.0.Z.MAIN.EUS:nss-0:3.53.1-11.el8_2</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
For details on how to apply this update, which includes the changes described in this advisory, refer to:

https://access.redhat.com/articles/11258

After installing this update, applications using NSS (for example, Firefox) must be restarted for this update to take effect. After installing this update, applications using NSPR (for example, Firefox) must be restarted for this update to take effect.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2020:3280</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.53.1_release_notes</URL>
        <Description>https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.53.1_release_notes</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2020-12402</URL>
        <Description>CVE-2020-12402</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1826231</URL>
        <Description>bz#1826231: CVE-2020-12402 nss: Side channel vulnerabilities during RSA key generation</Description>
      </Reference>
    </References>
    <Acknowledgments><Acknowledgment><Description>Red Hat would like to thank the Mozilla Project for reporting this issue. Upstream acknowledges Billy Bob Brumley (Network and Information Security Group (NISEC), Cesar Pereida (Network and Information Security Group (NISEC), Nicola Tuveri (Network and Information Security Group (NISEC), and Yuval Yarom (Network and Information Security Group (NISEC) as the original reporters.</Description></Acknowledgment></Acknowledgments>
  </Vulnerability>
</cvrfdoc>
