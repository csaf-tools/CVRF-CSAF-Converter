<?xml version="1.0" encoding="utf-8"?>
<cvrfdoc xmlns="http://www.icasi.org/CVRF/schema/cvrf/1.1" xmlns:cvrf="http://www.icasi.org/CVRF/schema/cvrf/1.1">
  <DocumentTitle xml:lang="en">Red Hat Security Advisory: ACS 3.67 security and enhancement update</DocumentTitle>
  <DocumentType>Security Advisory</DocumentType>
  <DocumentPublisher Type="Vendor">
    <ContactDetails>secalert@redhat.com</ContactDetails>
    <IssuingAuthority>Red Hat Product Security</IssuingAuthority>
  </DocumentPublisher>
  <DocumentTracking>
    <Identification><ID>RHSA-2021:4902</ID></Identification>
    <Status>Final</Status>
    <Version>1</Version>
    <RevisionHistory>
       <Revision>
         <Number>1</Number>
         <Date>2021-12-01T17:22:00Z</Date>
         <Description>Current version</Description>
       </Revision>
    </RevisionHistory>
    <InitialReleaseDate>2021-12-01T17:22:00Z</InitialReleaseDate>
    <CurrentReleaseDate>2021-12-01T17:22:00Z</CurrentReleaseDate>
    <Generator>
      <Engine>Red Hat SDEngine 3.3.0</Engine>
      <Date>2021-12-01T20:23:00Z</Date>
    </Generator>
  </DocumentTracking>
  <DocumentNotes>
    <Note Title="Topic" Type="Summary" Ordinal="1" xml:lang="en">
Updated images are now available for Red Hat Advanced Cluster Security for
Kubernetes (RHACS).

Red Hat Product Security has rated this update as having a security impact of Moderate. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.
    </Note>
    <Note Title="Details" Type="General" Ordinal="2" xml:lang="en">
The release of RHACS 3.67 provides the following new features, bug fixes, security patches and system changes:

OpenShift Dedicated support

RHACS 3.67 is thoroughly tested and supported on OpenShift Dedicated on Amazon Web Services and Google Cloud Platform.

1. Use OpenShift OAuth server as an identity provider
If you are using RHACS with OpenShift, you can now configure the built-in OpenShift OAuth server as an identity provider for RHACS. 

2. Enhancements for CI outputs
Red Hat has improved the usability of RHACS CI integrations. CI outputs now show additional detailed information about the vulnerabilities and the security policies responsible for broken builds.

3. Runtime Class policy criteria
Users can now use RHACS to define the container runtime configuration that may be used to run a pod’s containers using the Runtime Class policy criteria.

Security Fix(es):

* civetweb: directory traversal when using the built-in example HTTP form-based file upload mechanism via the mg_handle_form_request API (CVE-2020-27304)

* nodejs-axios: Regular expression denial of service in trim function (CVE-2021-3749)

* nodejs-prismjs: ReDoS vulnerability (CVE-2021-3801)

* golang: net: incorrect parsing of extraneous zero characters at the beginning of an IP address octet (CVE-2021-29923)

* helm: information disclosure vulnerability (CVE-2021-32690)

* golang: archive/zip: malformed archive may cause panic or memory exhaustion (incomplete fix of CVE-2021-33196) (CVE-2021-39293)

* nodejs-path-parse: ReDoS via splitDeviceRe, splitTailRe and splitPathRe (CVE-2021-23343)

For more details about the security issue(s), including the impact, a CVSS score, acknowledgments, and other related information, refer to the CVE page(s) listed in the References section.

Bug Fixes
The release of RHACS 3.67 includes the following bug fixes:

1. Previously, when using RHACS with the Compliance Operator integration, RHACS did not respect or populate Compliance Operator TailoredProfiles. This has been fixed.

2. Previously, the Alpine Linux package manager (APK) in Image policy looked for the presence of apk package in the image rather than the apk-tools package. This issue has been fixed.

System changes
The release of RHACS 3.67 includes the following system changes:

1. Scanner now identifies vulnerabilities in Ubuntu 21.10 images.
2. The Port exposure method policy criteria now include route as an exposure method.
3. The OpenShift: Kubeadmin Secret Accessed security policy now allows the OpenShift Compliance Operator to check for the existence of the Kubeadmin secret without creating a violation.
4. The OpenShift Compliance Operator integration now supports using TailoredProfiles.
5. The RHACS Jenkins plugin now provides additional security information.
6. When you enable the environment variable ROX_NETWORK_ACCESS_LOG for Central, the logs contain the Request URI and X-Forwarded-For header values.
7. The default uid:gid pair for the Scanner image is now 65534:65534.
8. RHACS adds a new default Scope Manager role that includes minimum permissions to create and modify access scopes.
9. If microdnf is part of an image or shows up in process execution, RHACS reports it as a security violation for the Red Hat Package Manager in Image or the Red Hat Package Manager Execution security policies.
10. In addition to manually uploading vulnerability definitions in offline mode, you can now upload definitions in online mode. 
11. You can now format the output of the following roxctl CLI commands in table, csv, or JSON format: image scan, image check &amp; deployment check
12. You can now use a regular expression for the deployment name while specifying policy exclusions
    </Note>
    <Note Title="Terms of Use" Ordinal="3" Type="Legal Disclaimer" xml:lang="en">This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.</Note>
  </DocumentNotes>
  <DocumentDistribution xml:lang="en">Copyright © 2021 Red Hat, Inc. All rights reserved.</DocumentDistribution>
  <AggregateSeverity Namespace="https://access.redhat.com/security/updates/classification/">Moderate</AggregateSeverity>
  <DocumentReferences>
    <Reference Type="Self">
       <URL>https://access.redhat.com/errata/RHSA-2021:4902</URL>
       <Description>https://access.redhat.com/errata/RHSA-2021:4902</Description>
    </Reference>
    <Reference Type="External">
       <URL>https://access.redhat.com/security/updates/classification/#moderate</URL>
       <Description>https://access.redhat.com/security/updates/classification/#moderate</Description>
    </Reference>
  </DocumentReferences>
  <ProductTree xmlns="http://www.icasi.org/CVRF/schema/prod/1.1">
    <Branch Type="Product Family" Name="RHACS">
      <Branch Type="Product Name" Name="RHACS 3.67 for RHEL 8">
        <FullProductName ProductID="8Base-RHACS-3.67" CPE="cpe:/a:redhat:advanced_cluster_security:3.67::el8">RHACS 3.67 for RHEL 8</FullProductName>
      </Branch>
    </Branch>
    <Branch Type="Product Version" Name="advanced-cluster-security/rhacs-operator-bundle:3.67.0-2">
      <FullProductName ProductID="advanced-cluster-security/rhacs-operator-bundle:3.67.0-2" CPE="cpe:/a:redhat:advanced_cluster_security:3.67::el8">advanced-cluster-security/rhacs-operator-bundle:3.67.0-2</FullProductName>
    </Branch>
    <Branch Type="Product Version" Name="advanced-cluster-security/rhacs-rhel8-operator:3.67.0-3">
      <FullProductName ProductID="advanced-cluster-security/rhacs-rhel8-operator:3.67.0-3" CPE="cpe:/a:redhat:advanced_cluster_security:3.67::el8">advanced-cluster-security/rhacs-rhel8-operator:3.67.0-3</FullProductName>
    </Branch>
    <Relationship ProductReference="rhacs-operator-bundle-container-3.67.0-2" RelationType="Default Component Of" RelatesToProductReference="8Base-RHACS-3.67">
      <FullProductName ProductID="8Base-RHACS-3.67:rhacs-operator-bundle-container-3.67.0-2" CPE="cpe:/a:redhat:advanced_cluster_security:3.67::el8">rhacs-operator-bundle-container-3.67.0-2 as a component of RHACS 3.67 for RHEL 8</FullProductName>
    </Relationship>
    <Relationship ProductReference="rhacs-operator-container-3.67.0-3" RelationType="Default Component Of" RelatesToProductReference="8Base-RHACS-3.67">
      <FullProductName ProductID="8Base-RHACS-3.67:rhacs-operator-container-3.67.0-3" CPE="cpe:/a:redhat:advanced_cluster_security:3.67::el8">rhacs-operator-container-3.67.0-3 as a component of RHACS 3.67 for RHEL 8</FullProductName>
    </Relationship>
  </ProductTree>

  <Vulnerability Ordinal="1" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">civetweb: directory traversal when using the built-in example HTTP form-based file upload mechanism via the mg_handle_form_request API</Note></Notes>
    <DiscoveryDate>2021-10-21T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2021-10-18T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2020-27304</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>8Base-RHACS-3.67:rhacs-operator-bundle-container-3.67.0-2</ProductID>
      <ProductID>8Base-RHACS-3.67:rhacs-operator-container-3.67.0-3</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Important</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
To take advantage of these new features, fixes and changes, please upgrade Red Hat Advanced Cluster Security for Kubernetes to version 3.67.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2021:4902</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://groups.google.com/g/civetweb/c/yPBxNXdGgJQ</URL>
        <Description>https://groups.google.com/g/civetweb/c/yPBxNXdGgJQ</Description>
      </Reference>
      <Reference>
        <URL>https://jfrog.com/blog/cve-2020-27304-rce-via-directory-traversal-in-civetweb-http-server/</URL>
        <Description>https://jfrog.com/blog/cve-2020-27304-rce-via-directory-traversal-in-civetweb-http-server/</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2020-27304</URL>
        <Description>CVE-2020-27304</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=2016640</URL>
        <Description>bz#2016640: CVE-2020-27304 civetweb: directory traversal when using the built-in example HTTP form-based file upload mechanism via the mg_handle_form_request API</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="2" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">nodejs-axios: Regular expression denial of service in trim function</Note></Notes>
    <DiscoveryDate>2021-08-31T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2021-08-31T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2021-3749</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>8Base-RHACS-3.67:rhacs-operator-bundle-container-3.67.0-2</ProductID>
      <ProductID>8Base-RHACS-3.67:rhacs-operator-container-3.67.0-3</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
To take advantage of these new features, fixes and changes, please upgrade Red Hat Advanced Cluster Security for Kubernetes to version 3.67.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2021:4902</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://github.com/axios/axios/commit/5b457116e31db0e88fede6c428e969e87f290929</URL>
        <Description>https://github.com/axios/axios/commit/5b457116e31db0e88fede6c428e969e87f290929</Description>
      </Reference>
      <Reference>
        <URL>https://huntr.dev/bounties/1e8f07fc-c384-4ff9-8498-0690de2e8c31</URL>
        <Description>https://huntr.dev/bounties/1e8f07fc-c384-4ff9-8498-0690de2e8c31</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2021-3749</URL>
        <Description>CVE-2021-3749</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1999784</URL>
        <Description>bz#1999784: CVE-2021-3749 nodejs-axios: Regular expression denial of service in trim function</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="3" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">nodejs-prismjs: ReDoS vulnerability</Note></Notes>
    <DiscoveryDate>2021-09-15T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2021-09-11T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2021-3801</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>8Base-RHACS-3.67:rhacs-operator-bundle-container-3.67.0-2</ProductID>
      <ProductID>8Base-RHACS-3.67:rhacs-operator-container-3.67.0-3</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
To take advantage of these new features, fixes and changes, please upgrade Red Hat Advanced Cluster Security for Kubernetes to version 3.67.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2021:4902</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2021-3801</URL>
        <Description>CVE-2021-3801</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=2005445</URL>
        <Description>bz#2005445: CVE-2021-3801 nodejs-prismjs: ReDoS vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="4" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">nodejs-path-parse: ReDoS via splitDeviceRe, splitTailRe and splitPathRe</Note></Notes>
    <DiscoveryDate>2021-05-04T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2021-05-04T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2021-23343</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>8Base-RHACS-3.67:rhacs-operator-bundle-container-3.67.0-2</ProductID>
      <ProductID>8Base-RHACS-3.67:rhacs-operator-container-3.67.0-3</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Low</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
To take advantage of these new features, fixes and changes, please upgrade Red Hat Advanced Cluster Security for Kubernetes to version 3.67.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2021:4902</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://snyk.io/vuln/SNYK-JS-PATHPARSE-1077067</URL>
        <Description>https://snyk.io/vuln/SNYK-JS-PATHPARSE-1077067</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2021-23343</URL>
        <Description>CVE-2021-23343</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1956818</URL>
        <Description>bz#1956818: CVE-2021-23343 nodejs-path-parse: ReDoS via splitDeviceRe, splitTailRe and splitPathRe</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="5" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">golang: net: incorrect parsing of extraneous zero characters at the beginning of an IP address octet</Note></Notes>
    <DiscoveryDate>2021-08-07T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2021-03-22T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2021-29923</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>8Base-RHACS-3.67:rhacs-operator-bundle-container-3.67.0-2</ProductID>
      <ProductID>8Base-RHACS-3.67:rhacs-operator-container-3.67.0-3</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
To take advantage of these new features, fixes and changes, please upgrade Red Hat Advanced Cluster Security for Kubernetes to version 3.67.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2021:4902</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://sick.codes/sick-2021-016/</URL>
        <Description>https://sick.codes/sick-2021-016/</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2021-29923</URL>
        <Description>CVE-2021-29923</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1992006</URL>
        <Description>bz#1992006: CVE-2021-29923 golang: net: incorrect parsing of extraneous zero characters at the beginning of an IP address octet</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="6" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">helm: information disclosure vulnerability</Note></Notes>
    <DiscoveryDate>2021-06-17T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2021-06-16T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2021-32690</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>8Base-RHACS-3.67:rhacs-operator-bundle-container-3.67.0-2</ProductID>
      <ProductID>8Base-RHACS-3.67:rhacs-operator-container-3.67.0-3</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
To take advantage of these new features, fixes and changes, please upgrade Red Hat Advanced Cluster Security for Kubernetes to version 3.67.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2021:4902</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://github.com/helm/helm/security/advisories/GHSA-56hp-xqp3-w2jf</URL>
        <Description>https://github.com/helm/helm/security/advisories/GHSA-56hp-xqp3-w2jf</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2021-32690</URL>
        <Description>CVE-2021-32690</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=1978144</URL>
        <Description>bz#1978144: CVE-2021-32690 helm: information disclosure vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>

  <Vulnerability Ordinal="7" xmlns="http://www.icasi.org/CVRF/schema/vuln/1.1">
    <Notes><Note Title="Vulnerability Description" Type="General" Ordinal="1" xml:lang="en">golang: archive/zip: malformed archive may cause panic or memory exhaustion (incomplete fix of CVE-2021-33196)</Note></Notes>
    <DiscoveryDate>2021-09-17T00:00:00Z</DiscoveryDate>
    <ReleaseDate>2021-08-18T00:00:00Z</ReleaseDate>
    <Involvements><Involvement Party="Vendor" Status="Completed"></Involvement></Involvements>
    <CVE>CVE-2021-39293</CVE>
    <ProductStatuses><Status Type="Fixed">
      <ProductID>8Base-RHACS-3.67:rhacs-operator-bundle-container-3.67.0-2</ProductID>
      <ProductID>8Base-RHACS-3.67:rhacs-operator-container-3.67.0-3</ProductID>
    </Status></ProductStatuses>
    <Threats><Threat Type="Impact"><Description>Moderate</Description></Threat></Threats>
    <Remediations>
      <Remediation Type="Vendor Fix"><Description xml:lang="en">
To take advantage of these new features, fixes and changes, please upgrade Red Hat Advanced Cluster Security for Kubernetes to version 3.67.
    </Description>
      <URL>https://access.redhat.com/errata/RHSA-2021:4902</URL></Remediation>
    </Remediations>
    <References>
      <Reference>
        <URL>https://groups.google.com/g/golang-announce/c/dx9d7IOseHw</URL>
        <Description>https://groups.google.com/g/golang-announce/c/dx9d7IOseHw</Description>
      </Reference>
      <Reference>
        <URL>https://access.redhat.com/security/cve/CVE-2021-39293</URL>
        <Description>CVE-2021-39293</Description>
      </Reference>
      <Reference>
        <URL>https://bugzilla.redhat.com/show_bug.cgi?id=2006044</URL>
        <Description>bz#2006044: CVE-2021-39293 golang: archive/zip: malformed archive may cause panic or memory exhaustion (incomplete fix of CVE-2021-33196)</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrfdoc>
